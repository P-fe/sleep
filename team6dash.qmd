---
title: 'ìˆ˜ë©´ íš¨ìœ¨ì„± ë¶„ì„'
title-slide-attributes: 
  data-background-image: sleep.png
  data-background-opacity: "0.4"
author: '6ì¡° êµ¬êµë¹ˆ, ê¹€ìœ¤í¬, ì¡°ìµí˜„, ì‹ ì¸ì² '
subtitle: 'ë³€ìˆ˜ë³„ ìˆ˜ë©´ íŒ¨í„´ ë¶„ì„' 
format: 
  revealjs:
    theme: default
    scrollable: true
    slide-number: true
    toc: False
    toc-title: "ëª©ì°¨"
    transition: fade
    footer: '6ì¡°'
    width: 1280         # ğŸ’¡ ìŠ¬ë¼ì´ë“œ ë„ˆë¹„ í™•ì¥
    height: 800         # ğŸ’¡ ìŠ¬ë¼ì´ë“œ ë†’ì´ í™•ì¥
    margin: 0.05        # ğŸ’¡ ìŠ¬ë¼ì´ë“œ ì—¬ë°± ì¶•ì†Œ (ë” ë„“ê²Œ ì‚¬ìš©)
css: style.css      # ì»¤ìŠ¤í…€ CSS ì¶”ê°€
---

## ğŸ“Œ ëª©ì°¨ {.scrollable}

#### ğŸŸ¦ ì„œë¡ 
- ì£¼ì œ ì„ ì • ì´ìœ   
- ë°ì´í„° ì •ì˜  
- ë°ì´í„° ì „ì²˜ë¦¬  
- ë°ì´í„° EDA   

#### ğŸŸ© ë³¸ë¡ 
- ìƒê´€ê´€ê³„ ë¶„ì„  
- ë…ë¦½ ë³€ìˆ˜ ì„ íƒ ì´ìœ  / Deep sleep ì œì™¸ ì´ìœ 
- ë…ë¦½ë³€ìˆ˜ 4ê°œ ìš”ì¸  
  - ìš´ë™ë¹ˆë„ë³„ Light sleep %, Sleep Efficiency  
  - í¡ì—°ì—¬ë¶€ë³„ Light sleep %, Sleep Efficiency    
  - ìŒì£¼ì—¬ë¶€ë³„ Light sleep %, Sleep Efficiency  
  - ì¹´í˜ì¸ ì„ íƒ ì´ìœ  
- íšŒê·€ ëª¨ë¸ë§  
  - ëª¨ë¸ ì„ ì • ê³¼ì •  
  - ìµœì¢… ëª¨ë¸  

#### ğŸŸ¥ ê²°ë¡ 


# ì„œë¡ 

## ì£¼ì œì„ ì •ì´ìœ 

:::{.columns}

::: {.column width="50%"}
<br><br><br><br>  
ì•ˆë…•í•˜ì„¸ìš”, ì—¬ëŸ¬ë¶„!<br>
í•œ ì£¼ ë™ì•ˆ í”„ë¡œì íŠ¸ í•˜ì‹œëŠë¼ ë§ì´ í”¼ê³¤í•˜ì…¨ì£ ?<br>
í˜¹ì‹œ ì ì´ ë¶€ì¡±í•˜ì§„ ì•Šìœ¼ì…¨ë‚˜ìš”...?<br>
ì•„ë‹ˆë©´ ì§€ê¸ˆ... ì¡¸ê³  ê³„ì‹  ê±´ ì•„ë‹ˆì‹œì£ ?? ğŸ˜„<br>
:::

::: {.column width="50%"}
![](students.png){width=100%}
:::

:::

---

 âŸ¶ê°•ì‚¬ë‹˜ì˜ ì§ˆë¬¸ì— ëŒ€í•œ **ì‘ë‹µì„± ì €í•˜**  
 âŸ¶ìˆ˜ë©´ íš¨ìœ¨ í–¥ìƒì„ ìœ„í•´ Lsë¯¸ë˜ì›ê³¼ ìš°ë¦¬ëŠ” **ì–´ë– í•œ ë…¸ë ¥**ì„ í•´ì•¼í• ê¹Œ?

<div style="text-align: center;">
  <img src="students_2.png" style="width: 80%;" />
</div>


---

## ë°ì´í„° ì •ì˜

| êµ¬ë¶„             | ìš”ì•½ ì„¤ëª… |
|------------------|-----------|
| **REM Sleep**      | í•™ìŠµê³¼ ê¸°ì–µì„ ë•ê³ , ìƒìƒí•œ ê¿ˆì´ ë‚˜íƒ€ë‚˜ëŠ” ë‡Œ í™œì„± ìˆ˜ë©´ ë‹¨ê³„ |
| **Deep Sleep**     | ë‡Œ íšŒë³µê³¼ ì„±ì¥í˜¸ë¥´ëª¬ ë¶„ë¹„ê°€ ì¼ì–´ë‚˜ëŠ” ê°€ì¥ ê¹Šì€ ìˆ˜ë©´ ë‹¨ê³„ |
| **Light Sleep**    | ìˆ˜ë©´ì˜ ì ˆë°˜ ì´ìƒì„ ì°¨ì§€í•˜ë©°, ê¹Šì€ ìˆ˜ë©´ìœ¼ë¡œ ë„˜ì–´ê°€ê¸° ìœ„í•œ ì¤€ë¹„ ë‹¨ê³„ |
| **Sleep Efficiency** | ì‹¤ì œ ìˆ˜ë©´ ì‹œê°„ Ã· ì¹¨ëŒ€ì— ëˆ„ìš´ ì‹œê°„ìœ¼ë¡œ ìˆ˜ë©´ì˜ ì§ˆì„ í‰ê°€í•˜ëŠ” ì§€í‘œ |


| ë³€ìˆ˜ëª… (ì˜ë¬¸)             | ë³€ìˆ˜ëª… (í•œê¸€)         | ë°ì´í„° íƒ€ì… (ì˜ë¬¸) | ë°ì´í„° íƒ€ì… (í•œê¸€)     |
|---------------------------|------------------------|---------------------|-------------------------|
| ID                        | ID                     | int64               | ì •ìˆ˜í˜•                  |
| Age                       | ë‚˜ì´                   | int64               | ì •ìˆ˜í˜•                  |
| Gender                    | ì„±ë³„                   | object              | ë¬¸ìí˜• (ë²”ì£¼í˜• í¬í•¨)    |
| Bedtime                   | ì·¨ì¹¨ ì‹œê°„              | object              | ë¬¸ìí˜• (ë²”ì£¼í˜• í¬í•¨)    |
| Wakeup time               | ê¸°ìƒ ì‹œê°„              | object              | ë¬¸ìí˜• (ë²”ì£¼í˜• í¬í•¨)    |
| Sleep duration            | ìˆ˜ë©´ ì‹œê°„              | float64             | ì‹¤ìˆ˜í˜•                  |
| Sleep efficiency          | ìˆ˜ë©´ íš¨ìœ¨              | float64             | ì‹¤ìˆ˜í˜•                  |
| REM sleep percentage      | REM ìˆ˜ë©´ ë¹„ìœ¨          | int64               | ì •ìˆ˜í˜•                  |
| Deep sleep percentage     | ê¹Šì€ ìˆ˜ë©´ ë¹„ìœ¨         | int64               | ì •ìˆ˜í˜•                  |
| Light sleep percentage    | ì–•ì€ ìˆ˜ë©´ ë¹„ìœ¨         | int64               | ì •ìˆ˜í˜•                  |
| Awakenings                | ê¹¬ íšŸìˆ˜                | float64             | ì‹¤ìˆ˜í˜•                  |
| Caffeine consumption      | ì¹´í˜ì¸ ì„­ì·¨ëŸ‰          | float64             | ì‹¤ìˆ˜í˜•                  |
| Alcohol consumption       | ì•Œì½”ì˜¬ ì„­ì·¨ëŸ‰          | float64             | ì‹¤ìˆ˜í˜•                  |
| Smoking status            | í¡ì—° ì—¬ë¶€              | object              | ë¬¸ìí˜• (ë²”ì£¼í˜• í¬í•¨)    |
| Exercise frequency        | ìš´ë™ ë¹ˆë„              | float64             | ì‹¤ìˆ˜í˜•   


## ë°ì´í„° ì „ì²˜ë¦¬

```{python}
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from matplotlib.colors import LinearSegmentedColormap
import statsmodels.api as sm
from statsmodels.formula.api import ols
from scipy.stats import shapiro
from statsmodels.stats.diagnostic import het_breuschpagan
from scipy.stats import kruskal
from scipy.stats import chi2_contingency
from sklearn.linear_model import LinearRegression
from mlxtend.feature_selection import SequentialFeatureSelector as SFS
df = pd.read_csv('Sleep_Efficiency.csv')
```

```{python}
#| echo: true


# 1. 'Awakenings'ì™€ 'Exercise frequency' ìµœë¹ˆê°’ ê³„ì‚°
awakening_mode = df['Awakenings'].mode()[0]
exercise_mode = df['Exercise frequency'].mode()[0]
Alcohol_mode = df['Alcohol consumption'].mode()[0]
Caffeine_mode = df['Caffeine consumption'].mode()[0]

# 2. í•´ë‹¹ ì»¬ëŸ¼ì˜ ê²°ì¸¡ì¹˜ ìµœë¹ˆê°’ìœ¼ë¡œ ëŒ€ì²´
df['Awakenings'] = df['Awakenings'].fillna(awakening_mode)
df['Exercise frequency'] = df['Exercise frequency'].fillna(exercise_mode)
df['Alcohol consumption'] = df['Alcohol consumption'].fillna(Alcohol_mode)
df['Caffeine consumption'] = df['Caffeine consumption'].fillna(Caffeine_mode)

```


```{python}
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from matplotlib.colors import LinearSegmentedColormap
import statsmodels.api as sm
from statsmodels.formula.api import ols
from scipy.stats import shapiro
from statsmodels.stats.diagnostic import het_breuschpagan
from scipy.stats import kruskal
from scipy.stats import chi2_contingency



df = pd.read_csv('Sleep_Efficiency.csv')

# 1. 'Awakenings'ì™€ 'Exercise frequency' ìµœë¹ˆê°’ ê³„ì‚°
awakening_mode = df['Awakenings'].mode()[0]
exercise_mode = df['Exercise frequency'].mode()[0]

# 2. í•´ë‹¹ ì»¬ëŸ¼ì˜ ê²°ì¸¡ì¹˜ ìµœë¹ˆê°’ìœ¼ë¡œ ëŒ€ì²´
df['Awakenings'] = df['Awakenings'].fillna(awakening_mode)
df['Exercise frequency'] = df['Exercise frequency'].fillna(exercise_mode)

# 3. ë‚˜ë¨¸ì§€ ê²°ì¸¡ì¹˜ëŠ” 0ìœ¼ë¡œ ëŒ€ì²´
df = df.fillna(0)

# ê²°ì¸¡ì¹˜ ìµœì¢… í™•ì¸
missing_summary = df.isnull().sum()

awakening_mode, exercise_mode, missing_summary

df['Bedtime'] = pd.to_datetime(df['Bedtime'], errors='coerce')


df['bed_halfhour'] = df['Bedtime'].dt.hour + (df['Bedtime'].dt.minute >= 30) * 0.5
df['bed_halfhour'].value_counts().sort_index()

df.head(5)

```



## EDA(ë°ì´í„° í˜„í™©)

### ìš´ë™ ë¹ˆë„ì™€ ì ì˜ ê´€ê³„

:::{.column width="50%"}

```{python}
Exer_frq = df['Exercise frequency'].unique()
Exer_frq.sort()
# print('ìš´ë™ë¹ˆë„ ìˆ˜ : ', Exer_frq)
Ef_Lsp = df.groupby('Exercise frequency')['Light sleep percentage'].mean()
Ef_SE = df.groupby('Exercise frequency')['Sleep efficiency'].mean()

# ìš´ë™ë¹ˆë„ì— ë”°ë¥¸ light sleep ê·¸ë˜í”„
norm_values = (Ef_Lsp .values - min(Ef_Lsp .values)) / (max(Ef_Lsp .values) - min(Ef_Lsp .values))
colors = [(0.56, 0.93, 0.56, alpha) for alpha in norm_values]
plt.figure(figsize=(5, 5))
plt.bar(Ef_Lsp .index, Ef_Lsp .values, color=colors, edgecolor='black')
plt.title('Light sleep by E.F')
plt.xlabel('Frequency')
plt.ylabel('Light sleep')
plt.ylim(10,35)
plt.show()
```

:::

:::{.column width="50%"}

```{python}
norm_values = (Ef_SE.values - min(Ef_SE.values)) / (max(Ef_SE.values) - min(Ef_SE.values))
colors = [(0.56, 0.93, 0.56, alpha) for alpha in norm_values]
plt.figure(figsize=(5, 5))
plt.bar(Ef_SE.index, Ef_SE.values, color=colors, edgecolor='black')
plt.title('Sleep Efficiency by E.F')
plt.xlabel('Frequency')
plt.ylabel('Sleep Efficiency')
plt.ylim(0.5,1)
plt.show()
```

:::

---

### ìŒì£¼ ì—¬ë¶€ì™€ ì ì˜ ê´€ê³„ 

:::{.column width="50%"}

```{python}

# 2. Alcohol Group ì»¬ëŸ¼ ìƒì„± (0.0 vs Other)
def alcohol_binary_group(val):
    if val == 0.0:
        return '0.0'
    else:
        return 'Other'
df['Alcohol consumption'].unique()
df['Alcohol Binary Group'] = df['Alcohol consumption'].apply(alcohol_binary_group)
# ì·¨í•œ ì‚¬ëŒê³¼ ì•ˆì·¨í•œ ì‚¬ëŒê°„ì˜ ë°ì´í„° êµ¬ë¶„

non_drink = df[df['Alcohol Binary Group'] == '0.0' ]
drink =  df[df['Alcohol Binary Group'] == 'Other' ]

# ì•Œì½œ ê¸°ì¤€ light sleep percentage

# 2. Alcohol ê·¸ë£¹ ë‚˜ëˆ„ê¸°: 0.0 vs Other
def alcohol_binary_group(val):
    if val == 0.0:
        return '0.0'
    else:
        return 'Other'

df['Alcohol Binary Group'] = df['Alcohol consumption'].apply(alcohol_binary_group)

# 3. ê·¸ë£¹ë³„ í‰ê·  Light sleep percentage ê³„ì‚°
light_sleep_means = df.groupby('Alcohol Binary Group')['Light sleep percentage'].mean()

# 4. ë§‰ëŒ€ ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
plt.figure(figsize=(6, 5))
light_sleep_means.loc[['0.0', 'Other']].plot(
    kind='bar',
    color=['mediumaquamarine', 'indianred'],
    edgecolor='black'
)
plt.title("Average Light Sleep Percentage by Alcohol Group (0.0 vs Other)")
plt.xlabel("Alcohol Consumption Group")
plt.ylabel("Light Sleep Percentage")
plt.xticks(rotation=0)
plt.tight_layout()
plt.show()
```

:::

:::{.column width="50%"}


```{python}
# 4. ë§‰ëŒ€ ê·¸ë˜í”„ ì‹œê°í™”
# 3. ê·¸ë£¹ë³„ Sleep efficiency í‰ê·  ê³„ì‚°
group_means = df.groupby('Alcohol Binary Group')['Sleep efficiency'].mean()
plt.figure(figsize=(6, 5))
group_means.loc[['0.0', 'Other']].plot(
    kind='bar',
    color=['royalblue', 'lightcoral'],
    edgecolor='black'
)
plt.title("Average Sleep Efficiency by Alcohol Group (0.0 vs Other)")
plt.xlabel("Alcohol Consumption Group")
plt.ylabel("Sleep Efficiency")
plt.ylim(0, 1)
plt.xticks(rotation=0)
plt.tight_layout()
plt.show()
```

:::


# ë³¸ë¡ 

## ìƒê´€ê´€ê³„ ê·¸ë˜í”„

```{python}


# ìˆ˜ì¹˜í˜• ë³€ìˆ˜ë§Œ ì„ íƒ
numeric_df = df.select_dtypes(include='number')
# ìƒê´€ê³„ìˆ˜ í–‰ë ¬ ê³„ì‚°
corr_matrix = numeric_df.corr()
# ìˆ˜ì¹˜í˜• ë³€ìˆ˜ë§Œ ì„ íƒ
numeric_df = df.select_dtypes(include='number')
# ìƒê´€ê³„ìˆ˜ í–‰ë ¬ ê³„ì‚°
corr_matrix = numeric_df.corr()
# íˆíŠ¸ë§µ ì‹œê°í™”
plt.figure(figsize=(10, 7))
sns.heatmap(corr_matrix, 
            annot=True,         # ì…€ ì•ˆì— ìˆ«ì í‘œì‹œ
            fmt=".2f",          # ì†Œìˆ˜ì  ë‘˜ì§¸ìë¦¬ê¹Œì§€
            cmap="coolwarm",    # ìƒ‰ìƒ ë§µ
            square=True, 
            linewidths=0.5)
plt.title("Correlation matrix heatmap of numerical features")
plt.tight_layout()
plt.grid(False)
plt.show()
```

---


## ë…ë¦½ ë³€ìˆ˜ ì„ íƒ ì´ìœ  / Deep sleep ì œì™¸ ì´ìœ 


```{python}
X = df[[
    'Caffeine consumption',
    'Alcohol consumption',
    'Exercise frequency',
    'Awakenings',
    'REM sleep percentage',
    'Deep sleep percentage',
    'Light sleep percentage'
]]
y = df['Sleep efficiency']
# ìƒìˆ˜í•­ ì¶”ê°€
X_const = sm.add_constant(X)
# OLS íšŒê·€ ëª¨ë¸ ì í•©
model = sm.OLS(y, X_const).fit()
# model.summary()

```


| ë³€ìˆ˜                   | ê³„ìˆ˜ (Î²)     | p-value   | ìœ ì˜ì„± | í•´ì„                             |
|------------------------|--------------|-----------|--------|----------------------------------|
| Caffeine consumption   | +0.000024    | 0.809     | âŒ     | ì˜í–¥ ì—†ìŒ                        |
| Alcohol consumption    | -0.0056      | 0.005     | âœ…     | ì•Œì½”ì˜¬ â†‘ â†’ ìˆ˜ë©´ íš¨ìœ¨ â†“          |
| Exercise frequency     | +0.0050      | 0.021     | âœ…     | ìš´ë™ â†‘ â†’ ìˆ˜ë©´ íš¨ìœ¨ â†‘            |
| Awakenings             | -0.0308      | <0.001    | âœ…     | ìì£¼ ê¹°ìˆ˜ë¡ ìˆ˜ë©´ íš¨ìœ¨ â†“         |
| REM sleep %            | +0.0035      | <0.001    | âœ…     | REM â†‘ â†’ ìˆ˜ë©´ íš¨ìœ¨ â†‘             |
| Deep sleep %           | -0.0006      | 0.643     | âŒ     | ì˜í–¥ ì—†ìŒ                        |
| Light sleep %          | -0.0068      | <0.001    | âœ…     | Light â†‘ â†’ ìˆ˜ë©´ íš¨ìœ¨ â†“           |

![](abc.png){width=100%}

Light sleepì„ ì„ íƒí•œ ì´ìœ (ë‹¤ì¤‘ê³µì‚°ì„±): Deep sleepì„ ëº€ì´ìœ ëŠ” ê°œë³„ ìƒê´€ì—ì„œëŠ” ìœ ì˜í–ˆì§€ë§Œ
íšŒê·€ì—ì„œëŠ” ë‹¤ë¥¸ ë³€ìˆ˜ë“¤ê³¼ ê²¹ì¹˜ëŠ” ì˜í–¥(ê³µì‚°ì„±) ë•Œë¬¸ì— ìœ ì˜í•˜ì§€ ì•Šê²Œ ë‚˜ì˜¬ìˆ˜ ìˆìŒ

---

## ë…ë¦½ë³€ìˆ˜ 4ê°œ ìš”ì¸

### ë¶„ì„ ëŒ€ìƒ ë° ë°©ë²• ìˆœì„œ

- ë¶„ì„ ëŒ€ìƒ ìˆœì„œ
    - ìš´ë™ ë¹ˆë„ Exercise frequency (0íšŒ ~ 5íšŒ)
    - í¡ì—° ì—¬ë¶€ Smoker / Non_Smoker
    - ìŒì£¼ ì—¬ë¶€ Other  / 0.0
    - ì¹´í˜ì¸ ì—¬ë¶€ 

- ë¶„ì„ ë°©ë²• ìˆœì„œ
    - ì •ê·œì„± ê²€ì • ê·¸ë˜í”„
    - ì •ê·œì„± ê²€ì • ìˆ˜ì¹˜
    - ìœ ì˜ì„± ê²€ì •


---

### ì²«ë²ˆì§¸ : ìš´ë™ë¹ˆë„ë³„ Light sleep %

- ì •ê·œì„± ê²€ì • 

```{python}
Ef_0 = df[df['Exercise frequency']== 0]
Ef_1 = df[df['Exercise frequency']== 1]
Ef_2 = df[df['Exercise frequency']== 2]
Ef_3 = df[df['Exercise frequency']== 3]
Ef_4 = df[df['Exercise frequency']== 4]
Ef_5 = df[df['Exercise frequency']== 5]


fig, axes = plt.subplots(2, 3, figsize=(15, 8))
axes = axes.flatten()
for i in range(6):
    sns.kdeplot(
        df[df['Exercise frequency'] == i]['Light sleep percentage'].dropna(),
        ax=axes[i],
        fill=True,
        color=sns.color_palette("tab10")[i],
    )
    axes[i].set_title(f"Exercise {i}")
    axes[i].set_xlim(0, 100)
    axes[i].grid(True, linestyle='--', alpha=0.3)
plt.tight_layout(rect=[0, 0, 1, 0.95])
plt.show()
```

```{python}
Ef_0_l = shapiro(Ef_0['Light sleep percentage'])
Ef_1_l = shapiro(Ef_1['Light sleep percentage'])
Ef_2_l = shapiro(Ef_2['Light sleep percentage'])
Ef_3_l = shapiro(Ef_3['Light sleep percentage'])
Ef_4_l = shapiro(Ef_4['Light sleep percentage'])
Ef_5_l = shapiro(Ef_5['Light sleep percentage'])

# print('ìš´ë™ 0ë²ˆê³¼ light sleep ì •ê·œì„± ê²€ì •', Ef_0_l.pvalue )
# print('ìš´ë™ 1ë²ˆê³¼ light sleep ì •ê·œì„± ê²€ì •', Ef_1_l.pvalue )
# print('ìš´ë™ 2ë²ˆê³¼ light sleep ì •ê·œì„± ê²€ì •', Ef_2_l.pvalue )
# print('ìš´ë™ 3ë²ˆê³¼ light sleep ì •ê·œì„± ê²€ì •', Ef_3_l.pvalue )
# print('ìš´ë™ 4ë²ˆê³¼ light sleep ì •ê·œì„± ê²€ì •', Ef_4_l.pvalue )
# print('ìš´ë™ 5ë²ˆê³¼ light sleep ì •ê·œì„± ê²€ì •', Ef_5_l.pvalue )
# print("ëª¨ë“ ê°’ì´ ë§¤ìš° ì‘ì€ê°’ì´ë‹¤, ì¦‰ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ê³  ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤.")
```


| ê²€ì • í•­ëª©            | ê·€ë¬´ê°€ì„¤(Hâ‚€)                         | p-value    | í•´ì„                 | ê°€ì • ë§Œì¡± ì—¬ë¶€ |
|---------------------|------------------------------------|------------|----------------------|----------------|
| ìš´ë™ íšŸìˆ˜ 0ë²ˆ        | ì´ ë³€ìˆ˜ëŠ” ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤.            | 6.49e-12   | ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤. | âŒ            |
| ìš´ë™ íšŸìˆ˜ 1ë²ˆ        | ì´ ë³€ìˆ˜ëŠ” ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤.            | 3.79e-13   | ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤. | âŒ            |
| ìš´ë™ íšŸìˆ˜ 2ë²ˆ        | ì´ ë³€ìˆ˜ëŠ” ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤.            | 8.61e-10   | ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤. | âŒ            |
| ìš´ë™ íšŸìˆ˜ 3ë²ˆ        | ì´ ë³€ìˆ˜ëŠ” ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤.            | 5.54e-14   | ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤. | âŒ            |
| ìš´ë™ íšŸìˆ˜ 4ë²ˆ        | ì´ ë³€ìˆ˜ëŠ” ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤.            | 3.07e-09   | ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤. | âŒ            |
| ìš´ë™ íšŸìˆ˜ 5ë²ˆ        | ì´ ë³€ìˆ˜ëŠ” ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤.            | 2.15e-06   | ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤. | âŒ            |

---



- ìœ ì˜ì„± ê²€ì •


```{python}
result_k1 = kruskal(Ef_0['Light sleep percentage'], Ef_1['Light sleep percentage']
                 ,Ef_2['Light sleep percentage'],Ef_3['Light sleep percentage']
                 ,Ef_4['Light sleep percentage'],Ef_5['Light sleep percentage']) 
# print('ìš´ë™íšŸìˆ˜ì— ë”°ë¥¸ Light sleep ìœ ì˜ì„± ê²€ì • : ', result_k1.pvalue.round(5))
# print('pvalue ê°’ì´ 0.0003ë¡œ ì‘ê¸°ë•Œë¬¸ì— ê·¸ë£¹ê°„ ìœ ì˜í•œ ì°¨ì´ê°€ ìˆë‹¤.')
```

- **Kruskal-Wallis H ê²€ì • ì‚¬ìš©**
    - í¬ë£¨ìŠ¤ì¹¼-ì™ˆë¦¬ìŠ¤ ê²€ì • P_value = 0.0003
    - P_valueê°€ ë§¤ìš° ì‘ê¸° ë•Œë¬¸ì— ìš´ë™ë¹ˆë„ë³„ Light sleep % ê·¸ë£¹ê°„ ë°ì´í„°ì˜ ìœ ì˜í•œ ì°¨ì´ê°€ ì¡´ì¬í•œë‹¤.

---

### ì²«ë²ˆì§¸ : ìš´ë™ë¹ˆë„ë³„ Sleep efficiency

- ì •ê·œì„± ê²€ì •


```{python}
## Sleep efficiencyì™€ ìš´ë™ë¹ˆë„ ì •ê·œì„± ê²€ì • ê·¸ë˜í”„
fig, axes = plt.subplots(2, 3, figsize=(15, 8))
axes = axes.flatten()
for i in range(6):
    sns.kdeplot(
        df[df['Exercise frequency'] == i]['Light sleep percentage'].dropna(),
        ax=axes[i],
        fill=True,
        color=sns.color_palette("tab10")[i],
    )
    axes[i].set_title(f"Exercise {i}")
    axes[i].set_xlim(0, 70)
    axes[i].grid(True, linestyle='--', alpha=0.3)
plt.tight_layout(rect=[0, 0, 1, 0.95])
plt.show()

```

```{python}
Ef_0_e = shapiro(Ef_0['Sleep efficiency'])
Ef_1_e = shapiro(Ef_1['Sleep efficiency'])
Ef_2_e = shapiro(Ef_2['Sleep efficiency'])
Ef_3_e = shapiro(Ef_3['Sleep efficiency'])
Ef_4_e = shapiro(Ef_4['Sleep efficiency'])
Ef_5_e = shapiro(Ef_5['Sleep efficiency'])

# print('ìš´ë™ 0ë²ˆê³¼ ìˆ˜ë©´ íš¨ìœ¨ ì •ê·œì„± ê²€ì •', Ef_0_e.pvalue )
# print('ìš´ë™ 1ë²ˆê³¼ ìˆ˜ë©´ íš¨ìœ¨ ì •ê·œì„± ê²€ì •', Ef_1_e.pvalue )
# print('ìš´ë™ 2ë²ˆê³¼ ìˆ˜ë©´ íš¨ìœ¨ ì •ê·œì„± ê²€ì •', Ef_2_e.pvalue )
# print('ìš´ë™ 3ë²ˆê³¼ ìˆ˜ë©´ íš¨ìœ¨ ì •ê·œì„± ê²€ì •', Ef_3_e.pvalue )
# print('ìš´ë™ 4ë²ˆê³¼ ìˆ˜ë©´ íš¨ìœ¨ ì •ê·œì„± ê²€ì •', Ef_4_e.pvalue )
# print('ìš´ë™ 5ë²ˆê³¼ ìˆ˜ë©´ íš¨ìœ¨ ì •ê·œì„± ê²€ì •', Ef_5_e.pvalue )
# print("ëª¨ë“ ê°’ì´ ë§¤ìš° ì‘ì€ê°’ì´ë‹¤, ì¦‰ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ê³  ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤.")
```


| ê²€ì • í•­ëª©            | ê·€ë¬´ê°€ì„¤(Hâ‚€)                         | p-value    | í•´ì„                 | ê°€ì • ë§Œì¡± ì—¬ë¶€ |
|---------------------|------------------------------------|------------|----------------------|----------------|
| ìš´ë™ íšŸìˆ˜ 0ë²ˆ        | ì´ ë³€ìˆ˜ëŠ” ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤.            | 0.0015     | ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤. | âŒ            |
| ìš´ë™ íšŸìˆ˜ 1ë²ˆ        | ì´ ë³€ìˆ˜ëŠ” ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤.            | 4.67e-05   | ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤. | âŒ            |
| ìš´ë™ íšŸìˆ˜ 2ë²ˆ        | ì´ ë³€ìˆ˜ëŠ” ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤.            | 4.51e-05   | ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤. | âŒ            |
| ìš´ë™ íšŸìˆ˜ 3ë²ˆ        | ì´ ë³€ìˆ˜ëŠ” ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤.            | 4.93e-08   | ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤. | âŒ            |
| ìš´ë™ íšŸìˆ˜ 4ë²ˆ        | ì´ ë³€ìˆ˜ëŠ” ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤.            | 3.82e-07   | ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤. | âŒ            |
| ìš´ë™ íšŸìˆ˜ 5ë²ˆ        | ì´ ë³€ìˆ˜ëŠ” ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤.            | 0.0001     | ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤. | âŒ            |


---



- ìœ ì˜ì„± ê²€ì •

```{python}
result_k2 = kruskal(Ef_0['Sleep efficiency'], Ef_1['Sleep efficiency']
                 ,Ef_2['Sleep efficiency'],Ef_3['Sleep efficiency']
                 ,Ef_4['Sleep efficiency'],Ef_5['Sleep efficiency']) 
# print('ìš´ë™íšŸìˆ˜ì— ë”°ë¥¸ Light sleep ìœ ì˜ì„± ê²€ì • : ', result_k2.pvalue)
# print('pvalue ê°’ì´ ë§¤ìš° ì‘ê¸° ë•Œë¬¸ì— ê·¸ë£¹ê°„ ìœ ì˜í•œ ì°¨ì´ê°€ ìˆë‹¤.')
```

- **Kruskal-Wallis H ê²€ì • ì‚¬ìš©**
    - í¬ë£¨ìŠ¤ì¹¼-ì™ˆë¦¬ìŠ¤ ê²€ì • P_value = 5.757e-08
    - P_valueê°€ ë§¤ìš° ì‘ê¸° ë•Œë¬¸ì— ìš´ë™ë¹ˆë„ë³„ sleep efficiency ê·¸ë£¹ê°„ ë°ì´í„°ì˜ ìœ ì˜í•œ ì°¨ì´ê°€ ì¡´ì¬í•œë‹¤.

---

### ë‘ë²ˆì§¸ : í¡ì—° ì—¬ë¶€ë³„ Light sleep % 


```{python}
smokers = df[df['Smoking status']=='Yes']
nonsmokers = df[df['Smoking status']=='No']

smokers["Sleep efficiency"].mean()
nonsmokers["Sleep efficiency"].mean()


# í¡ì—°ì—¬ë¶€ ë° Light sleepê°„ ì •ê·œì„± ê²€ì •
smokers["Light sleep percentage"].mean()
nonsmokers["Light sleep percentage"].mean()
sns.kdeplot(smokers['Light sleep percentage'], label='Smoker', shade=True)
sns.kdeplot(nonsmokers['Light sleep percentage'], label='Non-smoker', shade=True)
plt.title("Smoker and Non_Smoker")
plt.legend()
plt.show()
# ê·¸ë¦¼ìœ¼ë¡œ ê·¸ë ¤ë³´ë©´ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ”ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.
```


```{python}
from scipy.stats import shapiro
result1 = shapiro(smokers['Light sleep percentage'])
result2 = shapiro(nonsmokers['Light sleep percentage'])
# print('smoker pvalue : ', result1.pvalue)
# print('non_smoker pvalue : ', result2.pvalue)
# print('ìƒ¤í”¼ë¡œ ìœŒí¬ ê²€ì • ê²°ê³¼ ê·€ë¬´ê°€ì„¤ ê¸°ê° ì¦‰, ì •ê·œì„±ì„ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤')

```

í¡ì—°ìì™€ ë¹„í¡ì—°ì ëª¨ë‘ ì •ê·œì„±ì„ ë”°ë¥´ì§€ ì•ŠëŠ”ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.

```{python}
# í¡ì—° ì—¬ë¶€ë³„ Light sleepì˜ ìœ ì˜ì„± ê²€ì •
from scipy.stats import mannwhitneyu
result = mannwhitneyu(smokers['Light sleep percentage'], nonsmokers['Light sleep percentage'], alternative='two-sided')
# print('Light_pvalue : ', result.pvalue.round(5))
# print('ë§Œíœ˜íŠ¸ë‹ˆ ê²€ì •ê²°ê³¼ p_value 0.00138. ë”°ë¼ì„œ í¡ì—°ìì™€ ë¹„í¡ì—°ìê°„ì˜ ìˆ˜ë©´ íš¨ìœ¨ ë°ì´í„°ì— ìœ ì˜í•œ ì°¨ì´ê°€ ì¡´ì¬í•œë‹¤.')
```

- **ë‘ë²ˆì§¸ : í¡ì—° ì—¬ë¶€ë³„ Light sleep % ì •ê·œì„±, ìœ ì˜ì„± ê²€ì •**
    - í¡ì—°ì ì¼ ë•Œ    P_value = 7.889e-14
    - ë¹„í¡ì—°ì ì¼ ë•Œ  P_value = 2.846e-23
    - ìƒ¤í”¼ë¡œ ìœŒí¬ ê²€ì • ê²°ê³¼ ë‘˜ë‹¤ ê·€ë¬´ê°€ì„¤ ê¸°ê°, ì¦‰ ì •ê·œì„±ì„ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤.<br>

    - ë§Œ íœ˜íŠ¸ë‹ˆ P_value = 9.388e-09
    - P_valueê°€ ë§¤ìš° ì‘ê¸° ë•Œë¬¸ì— í¡ì—°ìì™€ ë¹„í¡ì—°ìê°„ ë°ì´í„°ì˜ ìœ ì˜í•œ ì°¨ì´ê°€ ì¡´ì¬í•œë‹¤.


---

### ë‘ë²ˆì§¸ : í¡ì—° ì—¬ë¶€ë³„ Sleep efficiency

```{python}
# í¡ì—°ì—¬ë¶€ ë° Sleep efficiencyê°„ ì •ê·œì„± ê²€ì •
sns.kdeplot(smokers['Sleep efficiency'], label='Smoker', shade=True)
sns.kdeplot(nonsmokers['Sleep efficiency'], label='Non-smoker', shade=True)
plt.title("Distribution of Sleep Efficiency by Smoking Status")
plt.xlabel("Sleep Efficiency")
plt.ylabel("Density")
plt.legend()
plt.show()
# ê·¸ë¦¼ìœ¼ë¡œ ê·¸ë ¤ë³´ë©´ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ”ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.
```

```{python}
# í¡ì—° ì—¬ë¶€ë³„ Sleep efficiencyì˜ ì •ê·œì„± ê²€ì •
from scipy.stats import shapiro
result1 = shapiro(smokers['Sleep efficiency'])
result2 = shapiro(nonsmokers['Sleep efficiency'])
# print('pvalue : ', result1.pvalue)
# print('pvalue : ', result2.pvalue)
# print('ìƒ¤í”¼ë¡œ ìœŒí¬ ê²€ì • ê²°ê³¼ ê·€ë¬´ê°€ì„¤ ê¸°ê° ì¦‰, ì •ê·œì„±ì„ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤')
```


```{python}
# í¡ì—° ì—¬ë¶€ë³„ Sleep efficiencyì˜ ìœ ì˜ì„± ê²€ì •
from scipy.stats import mannwhitneyu
result = mannwhitneyu(smokers['Sleep efficiency'], nonsmokers['Sleep efficiency'], alternative='two-sided')
# print("p-value:", result.pvalue)
# print('ë§Œíœ˜íŠ¸ë‹ˆ ê²€ì •ê²°ê³¼ p_value ë§¤ìš°ì‘ë‹¤. ë”°ë¼ì„œ í¡ì—°ìì™€ ë¹„í¡ì—°ìê°„ì˜ ìˆ˜ë©´ íš¨ìœ¨ ë°ì´í„°ì— ìœ ì˜í•œ ì°¨ì´ê°€ ì¡´ì¬í•œë‹¤.')

```

- **í¡ì—° ì—¬ë¶€ë³„ Sleep efficiency ì •ê·œì„±, ìœ ì˜ì„± ê²€ì • ê²°ê³¼**
    - í¡ì—°ì ì¼ ë•Œ    P_value = 1.008e-10
    - ë¹„í¡ì—°ì ì¼ ë•Œ  P_value = 1.245e-09
    - ìƒ¤í”¼ë¡œ ìœŒí¬ ê²€ì • ê²°ê³¼ ë‘˜ë‹¤ ê·€ë¬´ê°€ì„¤ ê¸°ê°, ì¦‰ ì •ê·œì„±ì„ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤.<br>

    - ë§Œ íœ˜íŠ¸ë‹ˆ P_value = 9.388e-09
    - P_valueê°€ ë§¤ìš° ì‘ê¸° ë•Œë¬¸ì— í¡ì—°ìì™€ ë¹„í¡ì—°ìê°„ ë°ì´í„°ì˜ ìœ ì˜í•œ ì°¨ì´ê°€ ì¡´ì¬í•œë‹¤.

---

### ì„¸ë²ˆì§¸ : ìŒì£¼ ì—¬ë¶€ë³„ Light sleep %

```{python}
# 2. Alcohol Group ì»¬ëŸ¼ ìƒì„± (0.0 vs Other)
def alcohol_binary_group(val):
    if val == 0.0:
        return '0.0'
    else:
        return 'Other'
df['Alcohol consumption'].unique()
df['Alcohol Binary Group'] = df['Alcohol consumption'].apply(alcohol_binary_group)
# ì·¨í•œ ì‚¬ëŒê³¼ ì•ˆì·¨í•œ ì‚¬ëŒê°„ì˜ ë°ì´í„° êµ¬ë¶„

non_drink = df[df['Alcohol Binary Group'] == '0.0' ]
drink =  df[df['Alcohol Binary Group'] == 'Other' ]

# ì•Œì½œ ê¸°ì¤€ light sleep percentage

# 2. Alcohol ê·¸ë£¹ ë‚˜ëˆ„ê¸°: 0.0 vs Other
def alcohol_binary_group(val):
    if val == 0.0:
        return '0.0'
    else:
        return 'Other'

df['Alcohol Binary Group'] = df['Alcohol consumption'].apply(alcohol_binary_group)

# 3. ê·¸ë£¹ë³„ í‰ê·  Light sleep percentage ê³„ì‚°
light_sleep_means = df.groupby('Alcohol Binary Group')['Light sleep percentage'].mean()

```

```{python}
# ì•Œì½œ ê¸°ì¤€ light sleep percentage ì •ê·œì„± ê²€ì¦ 
sns.kdeplot(drink['Light sleep percentage'], label='drink', shade=True)
sns.kdeplot(non_drink['Light sleep percentage'], label='non_drink', shade=True)
plt.title("Drink and Non_Drink")
plt.legend()
plt.show()
```

```{python}

# ì•Œì½œ ì—¬ë¶€ ê¸°ì¤€ Sleep_Efficiency ìƒ¤í”¼ë¡œ ê²€ì •
result1 = shapiro(drink['Light sleep percentage'])
result2 = shapiro(non_drink['Light sleep percentage'])
# print('pvalue : ', result1.pvalue)
# print('pvalue : ', result2.pvalue)
# print('ìƒ¤í”¼ë¡œ ìœŒí¬ ê²€ì • ê²°ê³¼ ê·€ë¬´ê°€ì„¤ ê¸°ê° ì¦‰, ì •ê·œì„±ì„ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤')
```

```{python}

# ì•Œì½œ ì—¬ë¶€ ê¸°ì¤€ Sleep_Efficiency ìœ ì˜ì„± ê²€ì •
result = mannwhitneyu(drink['Light sleep percentage'], non_drink['Light sleep percentage'], alternative='two-sided')
# print("p-value:", result.pvalue)
# print('ë§Œíœ˜íŠ¸ë‹ˆ ê²€ì •ê²°ê³¼ p_value ë§¤ìš°ì‘ë‹¤. ë”°ë¼ì„œ í¡ì—°ìì™€ ë¹„í¡ì—°ìê°„ì˜ ìˆ˜ë©´ íš¨ìœ¨ ë°ì´í„°ì— ìœ ì˜í•œ ì°¨ì´ê°€ ì¡´ì¬í•œë‹¤.')

```

- **ìŒì£¼ ì—¬ë¶€ë³„ Light sleep % ì •ê·œì„±, ìœ ì˜ì„± ê²€ì • ê²°ê³¼**
    - ìŒì£¼ í–ˆì„ ë•Œ    P_value = 1.432e-15
    - ìŒì£¼ ì•ˆ í–ˆì„ ë•Œ P_value = 9.132e-23
    - ìƒ¤í”¼ë¡œ ìœŒí¬ ê²€ì • ê²°ê³¼ ë‘˜ë‹¤ ê·€ë¬´ê°€ì„¤ ê¸°ê°, ì¦‰ ì •ê·œì„±ì„ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤.<br>

    - ë§Œ íœ˜íŠ¸ë‹ˆ P_value = 7.948e-11
    - P_valueê°€ ë§¤ìš° ì‘ê¸° ë•Œë¬¸ì— í¡ì—°ìì™€ ë¹„í¡ì—°ìê°„ ë°ì´í„°ì˜ ìœ ì˜í•œ ì°¨ì´ê°€ ì¡´ì¬í•œë‹¤.

---

### ì„¸ë²ˆì§¸ : ìŒì£¼ ì—¬ë¶€ë³„ Sleep efficiency

```{python}

# ì•Œì½œ ì—¬ë¶€ ê¸°ì¤€ Sleep_Efficiency ì •ê·œì„± ê²€ì¦ 
sns.kdeplot(drink['Sleep efficiency'], label='drink', shade=True)
sns.kdeplot(non_drink['Sleep efficiency'], label='non_drink', shade=True)
plt.title("Drink and Non_Drink")
plt.legend()
plt.show()
```

```{python}

# ì•Œì½œ ì—¬ë¶€ ê¸°ì¤€ Sleep_Efficiency ìƒ¤í”¼ë¡œ ê²€ì •
result1 = shapiro(drink['Sleep efficiency'])
result2 = shapiro(non_drink['Sleep efficiency'])
# print('pvalue : ', result1.pvalue)
# print('pvalue : ', result2.pvalue)
# print('ìƒ¤í”¼ë¡œ ìœŒí¬ ê²€ì • ê²°ê³¼ ê·€ë¬´ê°€ì„¤ ê¸°ê° ì¦‰, ì •ê·œì„±ì„ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤')
```

```{python}

# ì•Œì½œ ì—¬ë¶€ ê¸°ì¤€ Sleep_Efficiency ìœ ì˜ì„± ê²€ì •
result = mannwhitneyu(drink['Sleep efficiency'], non_drink['Sleep efficiency'], alternative='two-sided')
# print("p-value:", result.pvalue)
# print('ë§Œíœ˜íŠ¸ë‹ˆ ê²€ì •ê²°ê³¼ p_value ë§¤ìš°ì‘ë‹¤. ë”°ë¼ì„œ í¡ì—°ìì™€ ë¹„í¡ì—°ìê°„ì˜ ìˆ˜ë©´ íš¨ìœ¨ ë°ì´í„°ì— ìœ ì˜í•œ ì°¨ì´ê°€ ì¡´ì¬í•œë‹¤.')
```

- **ìŒì£¼ ì—¬ë¶€ë³„ Sleep efficiency ì •ê·œì„±, ìœ ì˜ì„± ê²€ì • ê²°ê³¼**
    - ìŒì£¼ í–ˆì„ ë•Œ    P_value = 1.522e-07
    - ìŒì£¼ ì•ˆ í–ˆì„ ë•Œ P_value = 1.626e-12
    - ìƒ¤í”¼ë¡œ ìœŒí¬ ê²€ì • ê²°ê³¼ ë‘˜ë‹¤ ê·€ë¬´ê°€ì„¤ ê¸°ê°, ì¦‰ ì •ê·œì„±ì„ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤.<br>

    - ë§Œ íœ˜íŠ¸ë‹ˆ P_value = 8.686e-16
    - P_valueê°€ ë§¤ìš° ì‘ê¸° ë•Œë¬¸ì— í¡ì—°ìì™€ ë¹„í¡ì—°ìê°„ ë°ì´í„°ì˜ ìœ ì˜í•œ ì°¨ì´ê°€ ì¡´ì¬í•œë‹¤.

---

### ë„¤ë²ˆì§¸ : ì¹´í˜ì¸ ì—¬ë¶€ë³„ ì¹´ì´ì œê³± ê²€ì •

```{python}

## ì¹´í˜ì¸ ë³€ìˆ˜ ë„£ì—ˆë˜ ì´ìœ 
# íŒŒìƒ ë³€ìˆ˜ ìƒì„± (ì¹´ì´ì œê³±ìš© ì´ì§„í™”)
df['High_Caffeine'] = (df['Caffeine consumption'] > 3).astype(int)      # 3ë‹¨ìœ„ ì´ˆê³¼ â†’ ê³ ì¹´í˜ì¸
df['Short_Sleep'] = (df['Sleep duration'] < 6).astype(int)              # 6ì‹œê°„ ë¯¸ë§Œ â†’ ì§§ì€ ìˆ˜ë©´
df['High_Alcohol'] = (df['Alcohol consumption'] > 3).astype(int)        # 3ë‹¨ìœ„ ì´ˆê³¼ â†’ ê³ ì•Œì½œ
df['Low_Efficiency'] = (df['Sleep efficiency'] < 0.85).astype(int)      # 85% ë¯¸ë§Œ â†’ ìˆ˜ë©´ íš¨ìœ¨ ë‚®ìŒ
df['High_Exercise'] = (df["Exercise frequency"] > 2 ).astype(int)       # 3ë²ˆ ì´ìƒ -> ë§ì€ ìš´ë™ëŸ‰
df['Low_light_sleep'] = (df['Light sleep percentage'] < 25).astype(int)

# ì¹´ì´ì œê³± ê²€ì •í•  ë³€ìˆ˜ìŒ ì •ì˜
pairs = [
    ('High_Caffeine', 'Short_Sleep'),
    ('High_Caffeine', 'High_Alcohol'),
    ('High_Caffeine', 'Low_Efficiency'),
    ('High_Caffeine', 'High_Exercise'),
    ('High_Caffeine', 'Low_light_sleep')
]

# ì¹´ì´ì œê³± ê²€ì • ì‹¤í–‰
results = []

for var1, var2 in pairs:
    table = pd.crosstab(df[var1], df[var2])
    stat, p, dof, expected = chi2_contingency(table)
    results.append({
        "Variable 1": var1,
        "Variable 2": var2,
        "p-value": round(p, 5)
    })

# ê²°ê³¼ ë³´ê¸°
results_df = pd.DataFrame(results)
# print(results_df)
```


| ë³€ìˆ˜ 1         | ë³€ìˆ˜ 2           | p-value | ìœ ì˜ì„± | í•´ì„ ìš”ì•½                     |
|----------------|------------------|---------|--------|-------------------------------|
| High_Caffeine  | Short_Sleep      | 1.00000 | âŒ     | ê´€ê³„ ì—†ìŒ                    |
| High_Caffeine  | High_Alcohol     | 0.03796 | âœ…     | ê³ ì¹´í˜ì¸ê³¼ ê³ ì•Œì½œì€ ê´€ë ¨ ìˆìŒ |
| High_Caffeine  | Low_Efficiency   | 0.30201 | âŒ     | ìœ ì˜ë¯¸í•œ ê´€ê³„ ì•„ë‹˜            |
| High_Caffeine  | High_Exercise    | 0.00000 | âœ…     | ì¹´í˜ì¸ ë§ì„ìˆ˜ë¡ ìš´ë™ë„ ë§ìŒ    |
| High_Caffeine  | Low_light_sleep  | 0.74428 | âŒ     | ê´€ê³„ ì—†ìŒ                    |


- **ì¹´í˜ì¸ ì—¬ë¶€ë³„ ì¹´ì´ì œê³± ê²€ì • ê²°ê³¼**  
    Short_Sleep, Low_Efficiency, Low_light_sleepì€ ê·€ë¬´ê°€ì„¤ ì±„íƒ ì¦‰,
    ì¹´í˜ì¸ê³¼ ì„¸ë³€ìˆ˜ëŠ” ë…ë¦½ì ì´ë‹¤.

    ë°˜ëŒ€ë¡œ High_Alcohol, High_ExcerciseëŠ” ê·€ë¬´ê°€ì„¤ ê¸°ê° ì¦‰,
    ì¹´í˜ì¸ê³¼ ë‘ë³€ìˆ˜ëŠ” ì„œë¡œ ì—°ê´€ì´ ìˆë‹¤.

---

## ëª¨ë¸ ê²€ì •

- **ëª¨ë¸ ì„ ì • ê³¼ì •**

    - **step 1. ì¹´í˜ì¸ í¬í•¨í•œ ëª¨ë¸ë§**  
    ì •ê·œì„±, ë“±ë¶„ì‚°ì„±, QQplotì„ í†µí•´ ì„¤ëª…ë ¥ì„ ê°€ì§€ëŠ” ëª¨ë¸ì¸ì§€ íŒë‹¨.

    - **step 2. aic-scoreë¥¼ í†µí•´ ë§Œë“  ìµœì  ëª¨ë¸ë§**  
    ì •ê·œì„±, ë“±ë¶„ì‚°ì„±, QQplotì„ í†µí•´ ì„¤ëª…ë ¥ì„ ê°€ì§€ëŠ” ëª¨ë¸ì¸ì§€ íŒë‹¨.

    - **step 3. ì¹´í˜ì¸ì„ í¬í•¨í•œ ëª¨ë¸ vs ì¹´í˜ì¸ì„ ë¯¸í¬í•¨í•œ ëª¨ë¸ (ìµœì¢… ëª¨ë¸)**  
    â†’ `anova`ë¥¼ í†µí•´ ë‘ ëª¨ë¸ì„ ë¹„êµí•˜ì—¬ `ìµœì¢… ëª¨ë¸ ì„ ì •`

---

- **step 1. ì¹´í˜ì¸ í¬í•¨í•œ ëª¨ë¸ë§** 
    - ë…ë¦½ë³€ìˆ˜ : 'Light sleep percentage', 'Smoking status' ,'Alcohol consumption','Awakenings', 'Exercise frequency', `'Caffeine consumption'`
    - ì¢…ì†ë³€ìˆ˜ : 'Sleep efficiency'
    - `Breusch-Pagan` ì€ ê°€ì¥ ì§ê´€ì ì´ê³  ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ë“±ë¶„ì‚°ì„± ê²€ì¦ìœ¼ë¡œ, `ì”ì°¨ê°€ íŠ¹ì • ë³€ìˆ˜ì— ì˜í•´ ë‹¬ë¼ì§€ëŠ”ì§€` í™•ì¸í•˜ëŠ”ë° ìœ ë¦¬í•¨.
    -> í•´ë‹¹ í†µê³„ëŸ‰ì´ `ìœ ì˜ë¯¸í•˜ê²Œ í¬ë©´ ì´ë¶„ì‚°ì„± ì¡´ì¬`ë¼ê³  íŒë‹¨.

---

- **<ëª¨ë¸ë§ ê²°ê³¼>**
    - ëª¨ë¸ ì£¼ìš” ê²°ê³¼ ìš”ì•½í‘œ

| í•­ëª©             | ê°’            | í•´ì„ ìš”ì•½ |
|------------------|----------------|------------|
| **R-squared**    | 0.802          | ì„¤ëª…ë ¥ 80.2% |
| **Adj. R-squared** | 0.800        | ë³€ìˆ˜ ìˆ˜ ë°˜ì˜ ì„¤ëª…ë ¥ |
| **F-statistic**  | 361.3        | ëª¨ë¸ ì „ì²´ ìœ ì˜ |
| **Prob(F-statistic)** | 2.57e-154 | p < 0.001 â†’ ìœ ì˜ |
| **AIC**          | -1247          | ëª¨ë¸ ë¹„êµìš© (ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ) |
| **BIC**          | -1222          | ëª¨ë¸ ë¹„êµìš© (ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ) |



    - ì£¼ìš” ë³€ìˆ˜ ê³„ìˆ˜ (p < 0.05)

| ë³€ìˆ˜                   | ê³„ìˆ˜ (coef) | p-value | í•´ì„ ìš”ì•½ |
|------------------------|-------------|---------|-----------|
| Light sleep %          | -0.0056     | 0.000   | ìˆ˜ë©´íš¨ìœ¨ ê°ì†Œ (ìŒì˜í–¥) |
| Alcohol consumption    | -0.0075     | 0.000   | ìŒì£¼ â†’ íš¨ìœ¨ ì €í•˜ |
| Awakenings             | -0.0337     | 0.000   | ìì£¼ ê¹¨ë©´ â†“ |
| Exercise frequency     | +0.0043     | 0.037   | ìš´ë™ â†‘ â†’ íš¨ìœ¨ â†‘ |
| Yes                    | -0.0444     | 0.000   | í¡ì—° O â†’ íš¨ìœ¨ â†“|
| ~~Caffeine consumption~~ | 0.00007     | 0.493   | âŒ ìœ ì˜í•˜ì§€ ì•ŠìŒ |


---

- <ëª¨ë¸ë§ ê²€ì¦ ê²°ê³¼>
    - Q-Q Plotì—ì„œ ê·¹ë‹¨ê°’ì´ ì •ê·œì„ ì—ì„œ ë²—ì–´ë‚˜ë©° ì •ê·œì„± ê°€ì •ì´ ì¼ë¶€ ìœ„ë°°ë¨
    - ì”ì°¨ì™€ ì˜ˆì¸¡ê°’ ê°„ íŒ¨í„´ì—ì„œ ì´ë¶„ì‚°ì„±ê³¼ ì„ í˜•ì„± ìœ„ë°˜ì´ ë™ì‹œì— í™•ì¸ë¨
    - ë”°ë¼ì„œ ì´ íšŒê·€ëª¨í˜•ì€ ì”ì°¨ ê°€ì •ì„ ì¶©ì¡±í•˜ì§€ ëª»í•˜ë©° ë³´ì •ì´ í•„ìš”í•¨

| ê²€ì • í•­ëª©            | ê·€ë¬´ê°€ì„¤(Hâ‚€)                      | p-value    | í•´ì„                 | ê°€ì • ë§Œì¡± ì—¬ë¶€ |
|---------------------|----------------------------------|------------|----------------------|----------------|
| Shapiro-Wilk Test   | ì”ì°¨ëŠ” ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤         | 0.00028    | ì •ê·œì„± ìœ„ë°˜ (ê¸°ê°)   | âŒ            |
| Breusch-Pagan Test  | ì˜¤ì°¨í•­ì€ ë“±ë¶„ì‚°ì„±ì„ ê°€ì§„ë‹¤       | 0.0416    | ì´ë¶„ì‚°ì„± ì¡´ì¬ (ê¸°ê°) | âŒ            |

    
```{python}
#| echo: False

# ì›ë˜ ìˆ˜ì¹˜í˜• ë³€ìˆ˜ë“¤
num_vars = ['Light sleep percentage', 'Alcohol consumption','Awakenings', 'Exercise frequency', 'Caffeine consumption']

# ë²”ì£¼í˜• ë³€ìˆ˜ â†’ ë”ë¯¸ë¡œ ë³€í™˜
smoking_dummy = pd.get_dummies(df['Smoking status'], drop_first=True)

# ìµœì¢… X êµ¬ì„± (ìˆ˜ì¹˜í˜• + ë”ë¯¸ í•©ì¹˜ê¸°)
X = pd.concat([df[num_vars], smoking_dummy], axis=1)
X = X.astype(float)
X = X.dropna()
y = df['Sleep efficiency']
X_const = sm.add_constant(X)

# íšŒê·€ ëª¨ë¸ ì í•©
model = sm.OLS(y, X_const).fit()

# ëª¨ë¸ ê²°ê³¼ ì¶œë ¥
# print(model.summary())

# ì •ê·œì„± ê²€ì • (Shapiro-Wilk)
shapiro_stat, shapiro_p = shapiro(model.resid)
# print(f"\nShapiro-Wilk Test (ì”ì°¨ ì •ê·œì„± ê²€ì •):\nStatistic = {shapiro_stat:.4f}, p-value = {shapiro_p:.5f}")

# ë“±ë¶„ì‚°ì„± ê²€ì • (Breusch-Pagan)
# ë³€ìˆ˜ë¡œ ë‹¤ì–‘í• ë•Œ ë“±ë¶„ì‚°ì„± ê²€ì •ì€ Breusch-Pegan ì‚¬ìš©
bp_test = het_breuschpagan(model.resid, X_const)
bp_p = bp_test[1]
# print(f"\nBreusch-Pagan Test (ì”ì°¨ ë“±ë¶„ì‚°ì„± ê²€ì •):\np-value = {bp_p:.5f}")

```

::: {.columns}

:::{.column width="50%"}

```{python}
#| echo: false
#| fig-align: center
#| fig-width: 5
#| fig-height: 4

# Q-Q Plot ê·¸ë¦¬ê¸°
plt.figure(figsize=(5, 5))
sm.qqplot(model.resid, line='45', fit=True)
_=plt.title("Q-Q Plot of Residuals (Based on Scatter Pattern)")
plt.grid(True)
plt.tight_layout()
plt.show()

# ì”ì°¨ë¶„ì‚°ì„± ê²€ì¦
plt.scatter(model.fittedvalues, model.resid)
plt.axhline(0, color='red')
_=plt.title("Fitted vs Residuals")
```

:::

:::

---

- **step 2. aic-scoreë¥¼ í†µí•´ ë§Œë“  ìµœì  ëª¨ë¸ë§**
    - ë…ë¦½ë³€ìˆ˜ : 'Light sleep percentage', 'Smoking status','Alcohol consumption','Awakenings', 'Exercise frequency'
    - ì¢…ì†ë³€ìˆ˜ : 'Sleep efficiency'
    - `aic-score` ë¥¼ í†µí•´ ìµœì ì˜ ë³€ìˆ˜ë¥¼ ì°¾ì•„ í•´ë‹¹ ë³€ìˆ˜ë¡œ ëª¨ë¸ ì§„í–‰
    -`Breusch-Pagan` ì„ í†µí•´ ì´ë¶„ì‚°ì„± í™•ì¸ ì§„í–‰ 

- <ëª¨ë¸ë§ ê²°ê³¼>
    - ëª¨ë¸ ì£¼ìš” ê²°ê³¼ ìš”ì•½í‘œ

| í•­ëª©                 | ê°’           | í•´ì„ ìš”ì•½                       |
|----------------------|--------------|----------------------------------|
| **R-squared**        | 0.802        | ì„¤ëª…ë ¥ 80.2%                     |
| **Adj. R-squared**   | 0.800        | ë³€ìˆ˜ ìˆ˜ ë°˜ì˜í•œ ì„¤ëª…ë ¥           |
| **F-statistic**      | 361.3        | ëª¨ë¸ ì „ì²´ ìœ ì˜                  |
| **Prob(F-statistic)**| 2.57e-154    | **p < 0.001**, ë§¤ìš° ìœ ì˜í•¨      |
| **AIC**              | -1247        | ëª¨ë¸ ë¹„êµìš© ì§€í‘œ (ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ) |
| **BIC**              | -1222        | ëª¨ë¸ ë¹„êµìš© ì§€í‘œ (ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ) |

    - ì£¼ìš” ë³€ìˆ˜ ê³„ìˆ˜ (p < 0.05)

| ë³€ìˆ˜                   | ê³„ìˆ˜ (coef) | p-value | í•´ì„ ìš”ì•½                    |
|------------------------|-------------|---------|------------------------------|
| Light sleep %          | -0.0056     | 0.000   | ìˆ˜ë©´íš¨ìœ¨ ê°ì†Œì— ìœ ì˜í•œ ì˜í–¥ |
| Alcohol consumption    | -0.0075     | 0.000   | ìŒì£¼ â†’ íš¨ìœ¨ ì €í•˜             |
| Awakenings             | -0.0337     | 0.000   | ìì£¼ ê¹°ìˆ˜ë¡ íš¨ìœ¨ í•˜ë½        |
| Exercise frequency     | +0.0043     | 0.037   | ìš´ë™ â†‘ â†’ ìˆ˜ë©´íš¨ìœ¨ ì¦ê°€       |
| Yes     | -0.0444     | 0.000   | í¡ì—° O â†’ ìˆ˜ë©´íš¨ìœ¨ ì €í•˜       |


---

- <ëª¨ë¸ë§ ê²€ì¦ ê²°ê³¼>
    - ì”ì°¨ê°€ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠìŒ
    - í•˜ì§€ë§Œ íšŒê·€ê³„ìˆ˜ ìì²´ê°€ ë‚˜ìœ ê±´ ì•„ë‹˜ ì˜ˆì¸¡ë ¥ ìì²´ì—ëŠ” í° ì˜í–¥ ì—†ìŒ
    - ë“±ë¶„ì‚°ì„±ì—ì„œëŠ” ì”ì°¨ì˜ ë¶„ì‚°ì„±ì´ ì¼ì •í•˜ì§€ ì•ŠìŒ -> ì´ë¶„ì‚°ì„± ì¡´ì¬
    - í…ŒìŠ¤íŠ¸ ë°ì´í„°ê°€ ì—†ìœ¼ë¯€ë¡œ rsquared_adjë¥¼ í™•ì¸í•œ ê²°ê³¼ ë‚˜ì˜ì§€ ì•Šì€ ì„¤ëª…ë ¥ì„ ê°€ì§.

| ê²€ì • í•­ëª©            | ê·€ë¬´ê°€ì„¤(Hâ‚€)                      | p-value    | í•´ì„                   |
|----------------------|----------------------------------|------------|------------------------|
| Shapiro-Wilk Test    | ì”ì°¨ëŠ” ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤         | 0.00033    | âŒ ì •ê·œì„± ìœ„ë°˜ (ê¸°ê°)   |
| Breusch-Pagan Test   | ì˜¤ì°¨í•­ì€ ë“±ë¶„ì‚°ì„±ì„ ê°€ì§„ë‹¤       | 0.03395    | âŒ ì´ë¶„ì‚°ì„± ì¡´ì¬ (ê¸°ê°) |


```{python}
#| echo: False
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
# ì›ë˜ ìˆ˜ì¹˜í˜• ë³€ìˆ˜ë“¤
num_vars = ['Light sleep percentage', 'Alcohol consumption','Awakenings', 'Exercise frequency', 'Caffeine consumption']

# ë²”ì£¼í˜• ë³€ìˆ˜ â†’ ë”ë¯¸ë¡œ ë³€í™˜
smoking_dummy = pd.get_dummies(df['Smoking status'], drop_first=True)

# ìµœì¢… X êµ¬ì„± (ìˆ˜ì¹˜í˜• + ë”ë¯¸ í•©ì¹˜ê¸°)
X = pd.concat([df[num_vars], smoking_dummy], axis=1)
X = X.astype(float)
X = X.dropna()
y = df['Sleep efficiency']
names = X.columns.tolist()

# AIC ê³„ì‚° í•¨ìˆ˜ (ì˜¤ë¥˜ ì—†ëŠ” ë²„ì „)
def aic_score(estimator, X_subset_np, y_np): 
    X_const = sm.add_constant(X_subset_np)
    model = sm.OLS(y_np, X_const).fit()
    return -model.aic  # AICê°€ ë‚®ì„ìˆ˜ë¡ ì¢‹ìœ¼ë¯€ë¡œ ìŒìˆ˜ ë°˜í™˜

# ëª¨ë¸ ì •ì˜
lr = LinearRegression()

# SFS (AIC ê¸°ì¤€ forward selection)
sfs = SFS(estimator=lr,
          k_features=(1, len(X.columns)),
          forward=True,
          floating=False,
          scoring=aic_score,
          cv=0,
          verbose=1)

# í”¼íŒ…
sfs.fit(X.values, y.values)

# ì„ íƒëœ ë³€ìˆ˜ ì¶”ì¶œ
selected_indices = list(sfs.k_feature_idx_)
selected_features = [names[i] for i in selected_indices]
print("ìµœì¢… ì„ íƒëœ ë³€ìˆ˜:", selected_features)

# ìµœì¢… ëª¨ë¸ í•™ìŠµ (statsmodels OLS)
X_selected = sm.add_constant(X[selected_features])
final_model = sm.OLS(y, X_selected).fit()

# ê²°ê³¼ ì¶œë ¥
# print(final_model.summary())# ì›ë˜ ìˆ˜ì¹˜í˜• ë³€ìˆ˜ë“¤


### ìµœì¢…ëª¨ë¸ ê²€ì¦í•˜ëŠ” ë°©ë²•
# 1. ì •ê·œì„± (Shapiro-Wilk)
shapiro_stat, shapiro_p = shapiro(final_model.resid)

# 2. ë“±ë¶„ì‚°ì„± (Breusch-Pagan)
bp_test = het_breuschpagan(final_model.resid, X_selected)
bp_p = bp_test[1]

# 3. Q-Q Plot
# plt.figure(figsize=(5, 4))  # QMDì—ì„œë„ ì‘ë™í•¨!
# sm.qqplot(final_model.resid, line='45', fit=True)
# plt.title("Q-Q Plot of Residuals")
# plt.tight_layout()
# plt.show()

### (í•´ì„)
# ì”ì°¨ëŠ” ëŒ€ì²´ë¡œ ì •ê·œì„±ì„ ë§Œì¡±í•˜ì§€ë§Œ, ê·¹ë‹¨ê°’ êµ¬ê°„ì—ì„œëŠ” ì¼ë¶€ ì™œê³¡ì´ ë‚˜íƒ€ë‚œë‹¤.
# ì´ëŠ” íšŒê·€ê³„ìˆ˜ì˜ ì •í™•ë„ì— í° ì˜í–¥ì„ ì£¼ì§€ëŠ” ì•Šìœ¼ë‚˜,
# ì •ë°€í•œ ì‹ ë¢°êµ¬ê°„ í•´ì„ì´ë‚˜ ê·¹ë‹¨ê°’ì— ë¯¼ê°í•œ ë¶„ì„ì—ì„œëŠ” ì£¼ì˜ê°€ í•„ìš”í•˜ë‹¤



# # 4. í…ŒìŠ¤íŠ¸ ë°ì´í„° ì—†ìœ¼ë¯€ë¡œ rsquared_adj í™•ì¸ì¸
# print(final_model.rsquared_adj)

# # 4. ê²°ê³¼ ì¶œë ¥
# print("ì„ íƒëœ ë³€ìˆ˜:", selected_features)
# print(f"Shapiro-Wilk p-value (ì •ê·œì„±): {shapiro_p:.5f}")
# print(f"Breusch-Pagan p-value (ë“±ë¶„ì‚°ì„±): {bp_p:.5f}")
# print("íšŒê·€ ìš”ì•½:")
# print(final_model.summary())



# - ì´ ëª¨ë¸ì€ ì´ë¶„ì‚°ì„±ì´ ì¡´ì¬í•´ì„œ í†µê³„ì  í•´ì„(pê°’, tê²€ì •)ì€ ì‹ ë¢°í•˜ê¸° ì–´ë ¤ì›€.ì™œëƒí•˜ë©´ ìˆ˜ë©´ íš¨ìœ¨ì„±, rem, deep, light sleepì€ ë§¤ìš° ì„œë¡œ ì—°ê´€ì„±ì´ ë†’ê¸° ë•Œë¬¸!
#     - ì˜ˆì¸¡ ì„±ëŠ¥ì´ ê´œì°®ë‹¤ë©´ ì˜ˆì¸¡ìš©ìœ¼ë¡œëŠ” ì—¬ì „íˆ í™œìš© ê°€ëŠ¥í•¨.
#     - êµ°ì§‘ë¶„ì„, ì£¼ì„±ë¶„ ë¶„ì„, kluster ë“±ì„ í†µí•´ ëª¨ë¸ì„ ë°˜ì˜í•˜ê±°ë‚˜ í˜¹ì€ ë°ì´í„° ë³€í™˜ì´ í•„ìš”í•´ë³´ì„

```



::: {.columns}

:::{.column width="50%"}

```{python}
#| echo: false
#| fig-align: center
#| fig-width: 5
#| fig-height: 4

# Q-Q Plot ê·¸ë¦¬ê¸°

sm.qqplot(final_model.resid, line='45', fit=True)
plt.title("Q-Q Plot of Residuals")
plt.grid(True)
plt.tight_layout()
plt.show()


# ì”ì°¨ë¶„ì‚°ì„± ê²€ì¦
plt.scatter(final_model.fittedvalues, final_model.resid)
plt.axhline(0, color='red')
plt.title("Fitted vs Residuals")
```

:::

:::


---

- **step 3. ì¹´í˜ì¸ì„ í¬í•¨í•œ ëª¨ë¸ vs ì¹´í˜ì¸ì„ ë¯¸í¬í•¨í•œ ëª¨ë¸ (ìµœì  ëª¨ë¸)** 

    - ì¶”ê°€ëœ ë³€ìˆ˜ëŠ” ê¸°ì¡´ ëª¨ë¸ ëŒ€ë¹„ ìˆ˜ë©´ íš¨ìœ¨ ì˜ˆì¸¡ì— í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•œ ê¸°ì—¬ë¥¼ í•˜ì§€ ì•Šì•˜ìœ¼ë©°,ë‘ ëª¨ë¸ ê°„ ì°¨ì´ëŠ” F(1, 446) = 0.28, p = 0.5964ë¡œ ë‚˜íƒ€ë‚¨
    - `ì¹´í˜ì¸ì„ ë¯¸í¬í•¨í•œ ëª¨ë¸`ì´ ì¶©ë¶„í•œ ì„¤ëª…ë ¥ì„ ìœ ì§€í•¨ì„ ì˜ë¯¸í•¨.


| ëª¨ë¸ | df | SSR       | Î”df | Î”SSR     | F      | p-value |
|------|----|-----------|-----|----------|--------|---------|
| M1   | 446 | 1.633088   | â€“   | â€“        | â€“      | â€“       |
| M2   | 445 | 1.632058   | 1   | 0.0010   | 0.2808  | 0.596438   |



# ê²°ë¡ 

## ìˆ˜ë©´íš¨ìœ¨ í–¥ìƒì„ ìœ„í•´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ?

- ğŸƒâ€â™‚ï¸ **ìš´ë™**: ê·œì¹™ì ì¸ ìš´ë™ì€ ìˆ˜ë©´ì˜ ì§ˆì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆìŒ

<br>

- ğŸ· **ìŒì£¼**: ìŒì£¼ëŠ” ì¼ì‹œì ì¸ ì¡¸ë¦¼ì„ ìœ ë„í•˜ì§€ë§Œ, ê¹Šì€ ìˆ˜ë©´ì„ ë°©í•´í•¨

<br>

- ğŸš¬ **í¡ì—°**: ë‹ˆì½”í‹´ì€ ìê·¹ì œë¡œ ì‘ìš©í•˜ì—¬ ìˆ˜ë©´ì„ ë°©í•´í•¨

<br>

- â˜• **ì¹´í˜ì¸**: ìœ ì˜ë¯¸í•œ ìƒê´€ì´ ì—†ë‹¤

## LSë¯¸ë˜ì›ì€ ìˆ˜ë©´íš¨ìœ¨ì„ ìœ„í•´ ë¬´ì—‡ì„ í•´ì•¼ í•˜ë©° ìš°ë¦¬ëŠ” ë¬´ì—‡ì„ í•´ì•¼ í•˜ëŠ”ê°€?

- ğŸ« **LSë¯¸ë˜ì›**: ì»¤ë¦¬í˜ëŸ¼ì— ì²´ìœ¡í™œë™ ì¶”ê°€

<br>

- ğŸ‘©â€ğŸ“ **êµìœ¡ìƒ**: í¡ì—° ìì œ, ê·œì¹™ì ì¸ ìš´ë™


## í†µê³„ì  í•œê³„





:::{.columns}

::: {.column width="50%"}

```{python}
plt.figure(figsize=(10, 7))
sns.heatmap(corr_matrix, 
            annot=True,         # ì…€ ì•ˆì— ìˆ«ì í‘œì‹œ
            fmt=".2f",          # ì†Œìˆ˜ì  ë‘˜ì§¸ìë¦¬ê¹Œì§€
            cmap="coolwarm",    # ìƒ‰ìƒ ë§µ
            square=True, 
            linewidths=0.5)
plt.title("Correlation matrix heatmap of numerical features")
plt.tight_layout()
plt.grid(False)
plt.show()
```

<br><br>
![](12.png){width=100%}

<br><br>

![](34.png){width=100%}

:::

::: {.column width="50%"}


<br>
1. ğŸ“‰ **ë‹¤ì¤‘ê³µì„ ì„±(Multicollinearity)**  
   - `Light sleep`ê³¼ `Deep sleep`ê°€ ì„œë¡œ ê°•í•˜ê²Œ ì—°ê´€ë˜ì–´ ìˆìŒ  
   - ë…ë¦½ ë³€ìˆ˜ë“¤ ê°„ì˜ ìƒê´€ì´ ë†’ì•„ íšŒê·€ ëª¨í˜•ì´ **ë¶ˆì•ˆì •**í•´ì§ˆ ìˆ˜ ìˆìŒ

<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
2. ğŸ“Š **ë¹„ì •ê·œ ë¶„í¬ + ì´ë¶„í¬ êµ¬ì¡°**  
   - ë…ë¦½ ë³€ìˆ˜ë“¤ì´ **ì •ê·œì„±ì„ ë”°ë¥´ì§€ ì•ŠìŒ**  
   - ë°€ë„ ë¶„í¬ì—ì„œ **ë‘ ê°œì˜ ë´‰ìš°ë¦¬(ì´ë´‰ì„±)**ê°€ ê´€ì°°ë¨  
   - ì´ëŠ” **ë°ì´í„° ë‚´ë¶€ì— í•˜ìœ„ ì§‘ë‹¨ì´ ì¡´ì¬**í•  ê°€ëŠ¥ì„±ì„ ì‹œì‚¬í•˜ë©°  
     ğŸ‘‰ **ì´ë¶„í™” ë¶„ì„** ë˜ëŠ” **ì£¼ì„±ë¶„ ë¶„ì„**ì´ ë” ì ì ˆí•  ìˆ˜ ìˆìŒ

:::
:::